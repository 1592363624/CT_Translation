<Window x:Class="CT_Translation.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="设置" Height="700" Width="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Style="{StaticResource MaterialDesignWindow}"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontSize="14">
    
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0">
            <!-- 服务选择 -->
            <GroupBox Header="翻译服务提供商" Style="{StaticResource MaterialDesignCardGroupBox}" Margin="0,0,0,16">
                <StackPanel Margin="8">
                    <TextBlock Text="选择要使用的翻译服务：" Margin="0,0,0,8" Opacity="0.7"/>
                    <ComboBox SelectedValue="{Binding SelectedProvider}" SelectedValuePath="Tag" Style="{StaticResource MaterialDesignOutlinedComboBox}">
                        <ComboBoxItem Content="Google 翻译 (免费接口)" Tag="GoogleFree" />
                        <ComboBoxItem Content="OpenAI 兼容接口 (OpenAI, DeepSeek, Kimi等)" Tag="OpenAI" />
                    </ComboBox>
                </StackPanel>
            </GroupBox>

            <!-- OpenAI 配置 -->
            <GroupBox Header="OpenAI / 兼容接口配置" Style="{StaticResource MaterialDesignCardGroupBox}">
                <StackPanel Margin="8">
                    <TextBlock Text="API 地址 (Base URL)" Margin="0,0,0,4" />
                    <TextBox Text="{Binding OpenAiApiUrl}" materialDesign:HintAssist.Hint="例如: https://api.openai.com/v1/chat/completions" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,12" />

                    <TextBlock Text="API Key" Margin="0,0,0,4" />
                    <TextBox Text="{Binding OpenAiApiKey, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="sk-..." Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,12" />
                    
                    <TextBlock Text="模型名称 (Model)" Margin="0,0,0,4" />
                    <TextBox Text="{Binding OpenAiModel}" materialDesign:HintAssist.Hint="例如: gpt-3.5-turbo, deepseek-chat" Style="{StaticResource MaterialDesignOutlinedTextBox}" Margin="0,0,0,12" />

                    <TextBlock Text="自定义提示词 (System Prompt)" Margin="0,0,0,4" />
                    <TextBox Text="{Binding CustomSystemPrompt}" 
                             materialDesign:HintAssist.Hint="例如: You are a professional game translator." 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}" 
                             AcceptsReturn="True"
                             TextWrapping="Wrap"
                             Height="80"
                             VerticalScrollBarVisibility="Auto"
                             Margin="0,0,0,12" />
                </StackPanel>
            </GroupBox>
        </StackPanel>

        <!-- 底部按钮 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="取消" Command="{Binding CancelCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" 
                    Style="{StaticResource MaterialDesignFlatButton}" Margin="0,0,8,0" />
            <Button Content="保存" Command="{Binding SaveCommand}" CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}" 
                    Style="{StaticResource MaterialDesignRaisedButton}" />
        </StackPanel>
    </Grid>
</Window>
